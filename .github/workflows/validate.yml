name: Validate Final Submission

on:
  pull_request:
    branches:
      - '**'

jobs:
  validate-submission:
    name: Validate PR
    runs-on: ubuntu-latest

    env:
      TARGET_BRANCH: ${{ secrets.CORRECT_BRANCH }}
      BACKGROUND_COLOR: ${{ secrets.CORRECT_COLOR }}
      HEADER_TEXT: ${{ secrets.CORRECT_HEADER_TEXT }}
      HEADER_SIZE: ${{ secrets.CORRECT_HEADER_SIZE }}
      IMAGE_HASH: ${{ secrets.CORRECT_IMAGE_HASH }}
      IMAGE_NAME: ${{ secrets.CORRECT_IMAGE_NAME }}
      LINK_URL: ${{ secrets.CORRECT_LINK_URL }}
      SECRET_PHRASE: ${{ secrets.CORRECT_PHRASE }}

    steps:
      - name: Check out PR branch
        uses: actions/checkout@v3

      - name: Install Python dependencies
        run: pip install beautifulsoup4 lxml

      - name: Debug file tree
        run: |
          echo "Files in repo:"
          find . -type f


      - name: ✅ Check Background Color
        run: python3 scripts/validate.py check-background

      - name: ✅ Check Header Text
        run: python3 scripts/validate.py check-header-text

      - name: ✅ Check Header Tag Level
        run: python3 scripts/validate.py check-header-size

      - name: ✅ Check Image Name
        run: python3 scripts/validate.py check-image-name

      - name: ✅ Check Image Link
        run: python3 scripts/validate.py check-image-link

      - name: ✅ Check Image Hash
        run: python3 scripts/validate.py check-image-hash


      - name: ✅ Check PR Secret Phrase
        run: python3 scripts/validate.py check-pr-message

      - name: ✅ Check Submission Lockout
        run: python3 scripts/validate.py check-lockout